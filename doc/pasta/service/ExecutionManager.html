<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_09) on Mon Nov 10 13:30:22 EST 2014 -->
<title>ExecutionManager</title>
<meta name="date" content="2014-11-10">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ExecutionManager";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExecutionManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../pasta/service/CompetitionManager.html" title="class in pasta.service"><span class="strong">Prev Class</span></a></li>
<li><a href="../../pasta/service/HandMarkingManager.html" title="class in pasta.service"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?pasta/service/ExecutionManager.html" target="_top">Frames</a></li>
<li><a href="ExecutionManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">pasta.service</div>
<h2 title="Class ExecutionManager" class="title">Class ExecutionManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>pasta.service.ExecutionManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@Service(value="executionManager")
@Repository
public class <span class="strong">ExecutionManager</span>
extends java.lang.Object</pre>
<div class="block">Execution Manager
 <p>
 Manages interaction between controller and data.
 This class works as an abstraction layer between the controller 
 and the underlying data models. This class contains the majority
 of the logic code dealing with objects and their interactions.</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>2014-01-31</dd>
<dt><span class="strong">Version:</span></dt>
  <dd>2.0</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Alex Radu</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../pasta/repository/AssessmentDAO.html" title="class in pasta.repository">AssessmentDAO</a></code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#assDao">assDao</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private org.springframework.context.ApplicationContext</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#context">context</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#logger">logger</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../pasta/repository/ResultDAO.html" title="class in pasta.repository">ResultDAO</a></code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#resultDAO">resultDAO</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../pasta/scheduler/ExecutionScheduler.html" title="class in pasta.scheduler">ExecutionScheduler</a></code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#scheduler">scheduler</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../pasta/service/ExecutionManager.html#ExecutionManager()">ExecutionManager</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#executeArenaCompetitionJob(pasta.scheduler.Job)">executeArenaCompetitionJob</a></strong>(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</code>
<div class="block">Execute a calculated competition</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#executeCalculatedCompetitionJob(pasta.scheduler.Job)">executeCalculatedCompetitionJob</a></strong>(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</code>
<div class="block">Execute a calculated competition</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#executeNormalJob(pasta.scheduler.Job)">executeNormalJob</a></strong>(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</code>
<div class="block">Execute a normal job (not competition)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#executeRemainingAssessmentJobs()">executeRemainingAssessmentJobs</a></strong>()</code>
<div class="block">Get outstanding non competition jobs</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#executeRemainingCompetitionJobs()">executeRemainingCompetitionJobs</a></strong>()</code>
<div class="block">Get outstanding competition jobs</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../pasta/service/ExecutionManager.html#setMyScheduler(pasta.scheduler.ExecutionScheduler)">setMyScheduler</a></strong>(<a href="../../pasta/scheduler/ExecutionScheduler.html" title="class in pasta.scheduler">ExecutionScheduler</a>&nbsp;myScheduler)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="assDao">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assDao</h4>
<pre>private&nbsp;<a href="../../pasta/repository/AssessmentDAO.html" title="class in pasta.repository">AssessmentDAO</a> assDao</pre>
</li>
</ul>
<a name="resultDAO">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resultDAO</h4>
<pre>private&nbsp;<a href="../../pasta/repository/ResultDAO.html" title="class in pasta.repository">ResultDAO</a> resultDAO</pre>
</li>
</ul>
<a name="scheduler">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scheduler</h4>
<pre>private&nbsp;<a href="../../pasta/scheduler/ExecutionScheduler.html" title="class in pasta.scheduler">ExecutionScheduler</a> scheduler</pre>
</li>
</ul>
<a name="context">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>context</h4>
<pre>private&nbsp;org.springframework.context.ApplicationContext context</pre>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logger</h4>
<pre>public static final&nbsp;org.apache.log4j.Logger logger</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ExecutionManager()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ExecutionManager</h4>
<pre>public&nbsp;ExecutionManager()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setMyScheduler(pasta.scheduler.ExecutionScheduler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMyScheduler</h4>
<pre>public&nbsp;void&nbsp;setMyScheduler(<a href="../../pasta/scheduler/ExecutionScheduler.html" title="class in pasta.scheduler">ExecutionScheduler</a>&nbsp;myScheduler)</pre>
</li>
</ul>
<a name="executeCalculatedCompetitionJob(pasta.scheduler.Job)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executeCalculatedCompetitionJob</h4>
<pre>private&nbsp;void&nbsp;executeCalculatedCompetitionJob(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</pre>
<div class="block">Execute a calculated competition
 <p>
 <ol>
        <li>Create a folder where this will run $location$/competitions/$compShortName$/competition/$date$</li>
        <li>Copy competition code</li>
        <li>Run ant: 
                <ol>
                        <li>build</li>
                        <li>compete</li>
                        <li>mark</li>
                        <li>clean</li>
                </ol>
        </li>
        <li>Deletes all except marks.csv and results.csv</li>
        <li>Delete the job from the queue</li>
        <li>Update the cached results</li>
        <li>If the competition is still live, add a new job to the queue to run the competition</li>
 </ol></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>job</code> - the calculated competition job</dd></dl>
</li>
</ul>
<a name="executeArenaCompetitionJob(pasta.scheduler.Job)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executeArenaCompetitionJob</h4>
<pre>private&nbsp;void&nbsp;executeArenaCompetitionJob(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</pre>
<div class="block">Execute a calculated competition
 <p>
 <ol>
        <li>Create a folder where this will run $compLocation$/arenas/$arenaName$/$date$</li>
        <li>Copy player code to $compLocation$/arenas/$arenaName$/$date$/player/$playerName$, look for active player, if no active players found, go for the latest retired player</li>
        <li>Copy competition code</li>
        <li>Run ant: 
                <ol>
                        <li>build</li>
                        <li>compete</li>
                        <li>mark</li>
                        <li>clean</li>
                </ol>
        </li>
        <li>Deletes all except marks.csv and results.csv</li>
        <li>Delete the job from the queue</li>
        <li>Update the cached results</li>
        <li>If the competition is still live and the arena is a repeating arena, add a new job to the queue to run the competition</li>
 </ol></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>job</code> - the arena competition job</dd></dl>
</li>
</ul>
<a name="executeNormalJob(pasta.scheduler.Job)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executeNormalJob</h4>
<pre>private&nbsp;void&nbsp;executeNormalJob(<a href="../../pasta/scheduler/Job.html" title="class in pasta.scheduler">Job</a>&nbsp;job)</pre>
<div class="block">Execute a normal job (not competition)
 <p>
 <ol>
        <li>Create a folder where this will run $location$/submissions/$username$/assessments/$assessmentName$/$date$/unitTests/$unitTestName$</li>
        <li>Copy unit test code (if there are multiple unit tests, run them all sequentially)</li>
        <li>Run ant: 
                <ol>
                        <li>build</li>
                        <li>test</li>
                        <li>clean</li>
                </ol>
        </li>
        <li>Deletes all except result.xml, compile.errors, run.errors</li>
        <li>Delete the job from the queue</li>
        <li>Update the cached results</li>
 </ol></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>job</code> - the job to run</dd></dl>
</li>
</ul>
<a name="executeRemainingAssessmentJobs()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executeRemainingAssessmentJobs</h4>
<pre>@Scheduled(fixedDelay=10000L)
public&nbsp;void&nbsp;executeRemainingAssessmentJobs()</pre>
<div class="block">Get outstanding non competition jobs
 <p>
 This method runs on a fixed delay (currently 10 sec). The system waits
 x ms between the end of the method and calling it again.
 
 This queries the database for outstanding jobs, get the list, process them
 all, then check the database again. When a check to the database is empty,
 the system goes back to waiting.</div>
</li>
</ul>
<a name="executeRemainingCompetitionJobs()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>executeRemainingCompetitionJobs</h4>
<pre>@Scheduled(fixedDelay=10000L)
public&nbsp;void&nbsp;executeRemainingCompetitionJobs()</pre>
<div class="block">Get outstanding competition jobs
 <p>
 This method runs on a fixed delay (currently 10 sec). The system waits
 x ms between the end of the method and calling it again.
 
 This queries the database for outstanding jobs, get the list, process them
 all, then check the database again. When a check to the database is empty,
 the system goes back to waiting.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExecutionManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../pasta/service/CompetitionManager.html" title="class in pasta.service"><span class="strong">Prev Class</span></a></li>
<li><a href="../../pasta/service/HandMarkingManager.html" title="class in pasta.service"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?pasta/service/ExecutionManager.html" target="_top">Frames</a></li>
<li><a href="ExecutionManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
